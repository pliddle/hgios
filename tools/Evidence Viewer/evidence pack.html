<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evidence Pack Viewer</title>
    <style>
        /* --- Base & Typography --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f9f9f9;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        /* --- NEW: Header Styling --- */
        .header-container {
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            margin-bottom: 10px;
            /* This is a flexbox layout for better alignment */
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header-container img {
            height: 60px;
            width: auto; /* Maintain aspect ratio */
        }
        /* End of new header styling */

        h1 {
            color: #1a1a1a;
            font-size: 2.2em;
            text-align: center;
            border-bottom: 2px solid #005a9c; /* School colour */
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        h2 {
            color: #005a9c; /* School colour */
            font-size: 1.6em;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            margin-top: 40px;
        }
        
        h3 {
            color: #333;
            font-size: 1.25em;
            margin-top: 25px;
        }

        p, ul {
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        /* --- Metadata Header --- */
        .pack-meta {
            display: flex;
            flex-wrap: wrap; /* Allows stacking on small screens */
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            padding: 15px;
            background-color: #fdfdfd;
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        /* --- QI Labels (HGIOS Colours) --- */
        .qi-labels {
            flex: 2; /* Give more space to labels */
            min-width: 300px;
        }

        .qi-label {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 20px; /* "Pill" shape */
            font-size: 0.9em;
            font-weight: bold;
            color: #fff;
            margin-right: 10px;
            margin-bottom: 5px; /* For wrapping */
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .qi-primary {
            background-color: #005a9c; /* HGIOS Leadership Blue */
        }

        .qi-secondary {
            background-color: #008a00; /* HGIOS Learning Green */
        }

        /* --- HGIOS 6-Point Scale --- */
        .impact-score {
            flex: 1;
            min-width: 220px; /* Adjusted width */
            text-align: right;
        }
        
        .impact-score strong {
            display: block;
            font-size: 0.9em;
            color: #555;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-weight: bold;
        }

        .impact-meter {
            display: flex;
            gap: 5px;
            justify-content: flex-end; /* Align to the right */
        }

        .impact-block {
            width: 30px; /* Adjusted for 6 blocks */
            height: 15px;
            border-radius: 3px;
            background-color: #e0e0e0; /* Default "off" state */
            border: 1px solid #ccc;
        }

        /* HGIOS Progressive Grade Colours */
        .hgios-1-unsatisfactory { background-color: #d9534f; border-color: #b0413e; } /* Red */
        .hgios-2-weak { background-color: #E67E22; border-color: #C0392B; } /* Orange */
        .hgios-3-satisfactory { background-color: #f7d94c; border-color: #c08a3e; } /* Yellow */
        .hgios-4-good { background-color: #5cb85c; border-color: #4a944a; } /* Green */
        .hgios-5-verygood { background-color: #008a00; border-color: #006b00; } /* Strong Green */
        .hgios-6-excellent { background-color: #005a9c; border-color: #004475; } /* Strong Blue */


        /* --- Section Styling --- */
        section {
            margin-bottom: 30px;
        }

        /* --- Quantitative Boxes --- */
        .quant-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .quant-box {
            background-color: #005a9c; /* Main accent color (Blue) */
            color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* Specific style for impact boxes */
        .impact-box {
            background-color: #008a00; /* Impact color (Green) */
        }

        /* --- Qualitative Speech Bubbles --- */
        .qual-container {
            margin-top: 20px;
        }

        .speech-bubble {
            background: #f4f8fb; /* Light blue tint */
            border-left: 5px solid #005a9c; /* Main accent color */
            padding: 15px 20px;
            margin-bottom: 15px;
            border-radius: 0 5px 5px 0;
            font-style: italic;
            font-size: 1.05em;
            position: relative;
        }

        .speech-bubble::before {
            content: '“';
            font-size: 3em;
            color: #005a9c;
            opacity: 0.2;
            position: absolute;
            top: -10px;
            left: 5px;
        }
        
        /* --- Evidence List Placeholder --- */
        .evidence-list ul {
            list-style-type: none;
            padding-left: 0;
        }

        .evidence-list li {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 8px;
            font-family: 'Courier New', Courier, monospace;
        }

        /* --- Print Button --- */
        @media print {
            body {
                background-color: #fff;
                box-shadow: none;
                margin: 0;
                padding: 0;
            }
            .container {
                box-shadow: none;
                margin: 0;
                max-width: 100%;
            }
            .print-button, .header-container { /* Hide header on print */
                display: none;
            }
            h1 {
                font-size: 2em;
            }
        }

        .print-button {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #005a9c;
            color: #fff;
            text-align: center;
            text-decoration: none;
            font-size: 1.2em;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 20px;
        }
        .print-button:hover {
            background-color: #004475;
        }

    </style>
</head>
<body>

    <div class="container">
        
        <div class="header-container">
            <img src="image/badge.png" alt="School Logo" class="header-image" onerror="this.src='https://placehold.co/150x60/eee/ccc?text=School+Logo'" >
            <img src="image/values.png" alt="Council Logo" class="header-image" onerror="this.src='https://placehold.co/150x60/eee/ccc?text=Council+Logo'">
        </div>


        <h1 id="pack-title">Loading...</h1>

        <div class="pack-meta">
            <div class="qi-labels">
                <span class="qi-label qi-primary" id="primary-qi"></span>
                <span class="qi-label qi-secondary" id="secondary-qi"></span>
            </div>
            <div class="impact-score">
                <strong id="hgios-rating-text"></strong>
                <div class="impact-meter" id="hgios-meter">
                    </div>
            </div>
        </div>

        <section id="what">
            <h2>What: Our Practice & Evidence</h2>
            <div id="what-text"></div>
            <h3>Participation Summary</h3>
            <div class="quant-grid" id="participation-grid"></div>
        </section>

        <section id="so-what">
            <h2>So What: The Impact & Outcomes</h2>
            <p id="so-what-text"></p>
            <h3>Quantitative Summary (Impact)</h3>
            <div class="quant-grid" id="impact-grid"></div>
            <h3>Qualitative Summary</h3>
            <div class="qual-container" id="qualitative-bubbles"></div>
        </section>

        <section id="what-now">
            <h2>What Now: The Next Steps</h2>
            <ul id="what-now-list"></ul>
        </section>

        <section id="evidence">
            <h2>Collated Evidence Files</h2>
            <p>This section will be automatically populated from the evidence library. The raw evidence files for this pack include:</p>
            <div class="evidence-list">
                <ul id="evidence-list"></ul>
            </div>
        </section>

        <button class="print-button" onclick="window.print()">Print / Save as PDF</button>
    </div>

    <script>
        // --- EMBEDDED JSON DATA ---
        // In a real-world scenario, you would fetch this file (e.g., fetch('evidence_packs.json').then(...))
        // But for a self-contained test file, embedding it here is the most reliable way.
        const evidencePacks = [
            {
                "id": 0,
                "title": "Evidence Pack: Self-Evaluation with Middle Leaders",
                "primary_qi_num": "1.3",
                "primary_qi_text": "Leadership of Change",
                "secondary_qi_num": "2.3",
                "secondary_qi_text": "Learning, Teaching & Assessment",
                "hgios_score": 6,
                "what_text": [
                    "Following on from COVID, the school had reduced visits to classrooms, and in discussion with the Self Evaluation group, it was decided to scale up departmental-level Quality Assurance, leading back into a structured approach to evaluation.",
                    "Over the last three years, Principal Teachers have led self evaluation within their departments by completing a yearly evaluation of evidence. Each year, this has been complimented with collaborative work, either with a school partner or trio, or with an external partner. In additional, the school leadership team gives every department feedback via observations and focus groups.",
                    "Last year, this was brought together when departments met with link senior leaders to review learning and teaching. This allowed departments use data provided by pupils, SLT and partner PTs to decide on an overall rating.",
                    "The Quality Assurance guide has been reviewed and modified each year based on emerging evidence. Twice-yearly judgements allow the school to track how departments are improving."
                ],
                "participation_summary": [
                    "100% of departments demonstrate positive ratings across all QIs",
                    "100% of departments have taken part in collaborative review of their evidence",
                    "Six departments have formed collaborative partnerships with other schools in EDC, including reciprocal visits",
                    "All focus groups across all departments demonstrated positive relationships and positive experiences for young people"
                ],
                "so_what_text": "The collated evidence shows improving self evaluation scores, but also richer feedback from departments each year. Longer term, relationships across the local authority are supporting high quality learning and teaching development, and validating the work of our departments effectively.",
                "impact_summary": [
                    "+15% increase in pupils reporting \"challenged appropriately\" (S1-S3 Focus Groups)",
                    "8/10 departments closed their identified S4 attainment gap by an average of 5%",
                    "100% of Department Plans now use pupil voice data to set their top priority"
                ],
                "qualitative_summary": [
                    "“We are much more certain about our direction of travel and how we measure ourselves using our own evidence”",
                    "“We have benefited greatly from speaking to colleagues in other schools and developing our practice and pedagogy”",
                    "“It is pleasing to see SLT, departmental and VSE feedback align positively”",
                    "“I have found that the SE process lets me produce an improvement plan that makes sense, much more easily”"
                ],
                "what_now_steps": [
                    "We want to start finding ways to share the quality work of departments with the school community in a visible, visual way.",
                    "We want to find ways to streamline pupil voice activities to support departments in capturing what is working, and allowing them to share this with others."
                ],
                "evidence_files": [
                    "Department improvement plans (last three years)",
                    "Standards and Quality (last three years)",
                    "Pupil Focus groups (last three years)",
                    "Observations (last three years)",
                    "SE reports (interim and full) last three years",
                    "Staff focus group transcript",
                    "VSE sample evidence"
                ]
            },
            {
                "id": 1,
                "title": "Evidence Pack: N5 Intervention Programme",
                "primary_qi_num": "3.2",
                "primary_qi_text": "Raising Attainment & Achievement",
                "secondary_qi_num": "3.1",
                "secondary_qi_text": "Ensuring Wellbeing, Equity & Inclusion",
                "hgios_score": 5,
                "what_text": [
                    "Our 2024 tracking data (Pre-Appeals) showed a dip in attainment in key subjects, with S4 pupils in our focus groups reporting high anxiety and 'feeling lost' in their revision.",
                    "We identified 58 pupils for targeted support in Maths, English, Physics, and History. We gathered evidence from focus groups, pre/post-intervention tracking data, and a 'Helps/Hinders' visual task."
                ],
                "participation_summary": [
                    "58 S4 pupils participated",
                    "4 subjects targeted: Maths, English, Physics, History",
                    "100% of participants co-created a 'study plan' with staff"
                ],
                "so_what_text": "The intervention had a measurable impact on both attainment and pupil confidence, proving the model is effective.",
                "impact_summary": [
                    "81% of participating pupils met or exceeded their target grade",
                    "90% of pupils reported 'feeling more confident' going into the exam",
                    "Attainment gap for this cohort closed by 5% in Maths"
                ],
                "qualitative_summary": [
                    "“I was failing Maths... you could stop and ask the 'stupid' questions without 30 other people looking at you.”",
                    "“The study skills part was the best, I finally learned *how* to revise.”"
                ],
                "what_now_steps": [
                    "Expand the programme to include Chemistry and Business Management.",
                    "Begin interventions in January, as feedback suggested March was 'too late'."
                ],
                "evidence_files": [
                    "N5_Intervention_Group_Transcript.docx",
                    "N5_Helps_Hinders_Wall.jpg",
                    "N5_Attainment_Data_2024-2025.xlsx"
                ]
            }
        ];

        // --- HGIOS LOOKUP TABLES ---
        const hgiosText = {
            1: "Unsatisfactory",
            2: "Weak",
            3: "Satisfactory",
            4: "Good",
            5: "Very Good",
            6: "Excellent"
        };

        const hgiosClasses = [
            "hgios-1-unsatisfactory",
            "hgios-2-weak",
            "hgios-3-satisfactory",
            "hgios-4-good",
            "hgios-5-verygood",
            "hgios-6-excellent"
        ];
        
        // --- HELPER FUNCTIONS ---

        /**
         * Populates the HGIOS meter based on the score
         */
        function buildHgiosMeter(score) {
            let meterHtml = "";
            for (let i = 0; i < 6; i++) {
                if (i < score) {
                    // This block is lit
                    meterHtml += `<span class="impact-block ${hgiosClasses[i]}"></span>`;
                } else {
                    // This block is unlit
                    meterHtml += `<span class="impact-block"></span>`;
                }
            }
            return meterHtml;
        }

        /**
         * Generic function to build a list of items (e.g., quant boxes, bubbles)
         */
        function buildHtmlList(items, itemType) {
            let html = "";
            switch (itemType) {
                case 'quant-box':
                    items.forEach(item => {
                        html += `<div class="quant-box">${item}</div>`;
                    });
                    break;
                case 'impact-box':
                     items.forEach(item => {
                        html += `<div class="quant-box impact-box">${item}</div>`;
                    });
                    break;
                case 'speech-bubble':
                    items.forEach(item => {
                        html += `<div class="speech-bubble">${item}</div>`;
                    });
                    break;
                case 'li':
                    items.forEach(item => {
                        html += `<li>${item}</li>`;
                    });
                    break;
                case 'p':
                     items.forEach(item => {
                        html += `<p>${item}</p>`;
                    });
                    break;
            }
            return html;
        }

        // --- MAIN LOAD FUNCTION ---
        window.onload = function() {
            try {
                // 1. Get index from URL (e.g., ?index=1)
                const urlParams = new URLSearchParams(window.location.search);
                let index = parseInt(urlParams.get('index'), 10) || 0; // Default to 0

                // 2. Get the correct data from the array
                if (index < 0 || index >= evidencePacks.length) {
                    index = 0; // Fallback for invalid index
                }
                const packData = evidencePacks[index];

                // 3. Populate the page
                // Set page title
                document.title = packData.title;

                // Header
                document.getElementById('pack-title').textContent = packData.title;
                document.getElementById('primary-qi').textContent = `Primary QI: ${packData.primary_qi_num} ${packData.primary_qi_text}`;
                document.getElementById('secondary-qi').textContent = `Secondary QI: ${packData.secondary_qi_num} ${packData.secondary_qi_text}`;
                
                // HGIOS Meter
                document.getElementById('hgios-rating-text').textContent = `Self-Evaluation: ${packData.hgios_score} - ${hgiosText[packData.hgios_score]}`;
                document.getElementById('hgios-meter').innerHTML = buildHgiosMeter(packData.hgios_score);

                // "What" Section
                document.getElementById('what-text').innerHTML = buildHtmlList(packData.what_text, 'p');
                document.getElementById('participation-grid').innerHTML = buildHtmlList(packData.participation_summary, 'quant-box');
                
                // "So What" Section
                document.getElementById('so-what-text').textContent = packData.so_what_text;
                document.getElementById('impact-grid').innerHTML = buildHtmlList(packData.impact_summary, 'impact-box');
                document.getElementById('qualitative-bubbles').innerHTML = buildHtmlList(packData.qualitative_summary, 'speech-bubble');

                // "What Now" Section
                document.getElementById('what-now-list').innerHTML = buildHtmlList(packData.what_now_steps, 'li');

                // "Evidence" Section
                document.getElementById('evidence-list').innerHTML = buildHtmlList(packExample.evidence_files, 'li');

            } catch (error) {
                console.error("Failed to load evidence pack:", error);
                document.getElementById('pack-title').textContent = "Error: Could not load Evidence Pack.";
            }
        };

    </script>
</body>
</html>